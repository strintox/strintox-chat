<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StrIntox Messenger</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%230088cc' d='M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M8,7.71V11.05L15.14,12L8,12.95V16.29L18,12L8,7.71Z'/%3E%3C/svg%3E" type="image/svg+xml">
    <script src="https://www.gstatic.com/firebasejs/9.19.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.19.1/firebase-storage-compat.js"></script>
</head>
<body>
    <!-- Страница авторизации -->
    <div id="auth-page">
        <div class="auth-container">
            <div class="logo">
                <h1>StrIntox</h1>
                <p>Онлайн-мессенджер</p>
            </div>
            <div class="tabs">
                <button class="tab-btn active" data-tab="login">Вход</button>
                <button class="tab-btn" data-tab="register">Регистрация</button>
            </div>
            
            <!-- Форма входа -->
            <form id="login-form" class="auth-form">
                <div class="form-group">
                    <input type="text" id="login-username" placeholder="Логин" required>
                </div>
                <div class="form-group">
                    <input type="password" id="login-password" placeholder="Пароль" required>
                </div>
                <button type="submit" class="btn-primary ripple">
                    <span class="material-icons">login</span>
                    <span>Войти</span>
                </button>
            </form>
            
            <!-- Форма регистрации -->
            <form id="register-form" class="auth-form" style="display: none;">
                <div class="form-group">
                    <input type="text" id="register-username" placeholder="Логин (уникальный)" required>
                </div>
                <div class="form-group">
                    <input type="email" id="register-email" placeholder="Email" required>
                </div>
                <div class="form-group">
                    <input type="password" id="register-password" placeholder="Пароль" required>
                </div>
                <button type="submit" class="btn-primary ripple">
                    <span class="material-icons">person_add</span>
                    <span>Зарегистрироваться</span>
                </button>
            </form>
        </div>
    </div>

    <!-- Главная страница мессенджера -->
    <div id="messenger-page" style="display: none;">
        <!-- Сайдбар с чатами -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="user-info">
                    <div id="current-user-avatar-container">
                        <img id="current-user-avatar" style="display: none;">
                        <div id="current-user-avatar-placeholder" class="avatar-placeholder"></div>
                        <span class="status-dot online"></span>
                    </div>
                    <span id="current-username">Имя пользователя</span>
                </div>
                <div class="header-actions">
                    <label class="theme-switch">
                        <input type="checkbox" id="theme-toggle">
                        <span class="slider round">
                            <span class="material-icons light-icon">light_mode</span>
                            <span class="material-icons dark-icon">dark_mode</span>
                        </span>
                    </label>
                    <button id="settings-btn" class="icon-btn ripple">
                        <span class="material-icons">menu</span>
                    </button>
                </div>
            </div>
            <div class="search-container">
                <div class="search-input">
                    <span class="material-icons">search</span>
                    <input type="text" id="chat-search" placeholder="Поиск в чатах...">
                </div>
            </div>
            <div id="chats-list" class="chats-list">
                <!-- Чаты будут добавлены динамически через JavaScript -->
            </div>
            <div class="new-chat-btn">
                <button id="new-chat-btn" class="icon-btn ripple">
                    <span class="material-icons">edit</span>
                </button>
            </div>
        </div>

        <!-- Основная область чата -->
        <div class="chat-area">
            <div id="empty-chat" class="empty-chat">
                <div class="empty-chat-icon">
                    <span class="material-icons">forum</span>
                </div>
                <p>Выберите чат или начните новую беседу</p>
            </div>

            <div id="active-chat" class="active-chat" style="display: none;">
                <div class="chat-header">
                    <div class="chat-info">
                        <img id="chat-avatar" style="display: none;">
                        <div class="chat-details">
                            <h3 id="chat-title">Название чата</h3>
                            <span id="chat-status" class="chat-status">в сети</span>
                        </div>
                    </div>
                    <div class="chat-actions">
                        <button class="icon-btn back-to-chats ripple">
                            <span class="material-icons">arrow_back</span>
                        </button>
                        <button class="icon-btn ripple">
                            <span class="material-icons">more_vert</span>
                        </button>
                    </div>
                </div>

                <div id="messages-container" class="messages-container">
                    <!-- Сообщения будут добавлены динамически через JavaScript -->
                </div>

                <div class="message-input-container">
                    <button class="icon-btn ripple">
                        <span class="material-icons">attach_file</span>
                    </button>
                    <div class="message-input">
                        <textarea id="message-text" placeholder="Напишите сообщение..."></textarea>
                    </div>
                    <button id="send-message-btn" class="icon-btn ripple">
                        <span class="material-icons">send</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно для создания нового чата -->
    <div id="new-chat-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Новый чат</h3>
                <button id="close-modal-btn" class="icon-btn ripple">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="search-input">
                    <span class="material-icons">search</span>
                    <input type="text" id="user-search" placeholder="Найти пользователя...">
                </div>
                <div id="users-list" class="users-list">
                    <!-- Пользователи будут добавлены динамически через JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно настроек профиля -->
    <div id="profile-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Настройки профиля</h3>
                <button id="close-profile-modal-btn" class="icon-btn ripple">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-body profile-settings">
                <div class="avatar-upload">
                    <div class="avatar-preview">
                        <img id="profile-avatar-preview" style="display: none;" alt="Avatar Preview">
                        <div id="profile-avatar-placeholder" class="avatar-placeholder-large"></div>
                        <div class="upload-progress">
                            <div class="circle-loader"></div>
                            <div class="upload-progress-text">Загрузка...</div>
                        </div>
                    </div>
                    <div class="avatar-actions">
                        <label for="avatar-upload" class="btn-secondary ripple">
                            <span class="material-icons">photo_camera</span>
                            <span>Выбрать фото</span>
                        </label>
                        <input type="file" id="avatar-upload" accept="image/*" style="display: none;">
                        <button id="save-avatar-btn" class="btn-primary ripple" disabled>Сохранить аватар</button>
                    </div>
                </div>
                <div class="profile-info">
                    <div class="form-group">
                        <label for="profile-username">Имя пользователя</label>
                        <input type="text" id="profile-username" readonly>
                    </div>
                    <div class="form-group">
                        <label for="profile-email">Email</label>
                        <input type="email" id="profile-email" readonly>
                    </div>
                    <div class="form-group">
                        <label for="profile-status">Статус онлайн</label>
                        <div class="status-indicator">
                            <span class="status-dot online"></span>
                            <span id="status-text">Вы в сети</span>
                        </div>
                    </div>
                    <button id="logout-btn" class="btn-danger ripple">
                        <span class="material-icons">logout</span>
                        Выйти из аккаунта
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="firebase-config.js"></script>
    <script src="app.js"></script>
</body>
</html> 